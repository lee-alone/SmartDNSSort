# Recursor å‰ç«¯é›†æˆå®ŒæˆæŠ¥å‘Š

## âœ… å‰ç«¯é›†æˆçŠ¶æ€ï¼š**å®Œæˆ**

æ‰€æœ‰å‰ç«¯ç»„ä»¶å·²å°±ä½ï¼ŒRecursor åŠŸèƒ½çš„å‰ç«¯ UI é›†æˆå·²å®Œæˆã€‚

---

## ğŸ“‹ å‰ç«¯é›†æˆæ¸…å•

### âœ… HTML ç»„ä»¶

**æ–‡ä»¶**ï¼š`webapi/web/components/config-recursor.html`

**çŠ¶æ€**ï¼šâœ… å·²åˆ›å»º

**åŒ…å«å†…å®¹**ï¼š
- âœ… å¯ç”¨/ç¦ç”¨å¼€å…³
- âœ… ç«¯å£é…ç½®è¾“å…¥æ¡†
- âœ… å®æ—¶çŠ¶æ€æ˜¾ç¤º
- âœ… ä¿¡æ¯é¢æ¿

**ç‰¹æ€§**ï¼š
- âœ… å“åº”å¼è®¾è®¡ï¼ˆç§»åŠ¨ç«¯å‹å¥½ï¼‰
- âœ… æ·±è‰²æ¨¡å¼æ”¯æŒ
- âœ… i18n å›½é™…åŒ–æ”¯æŒ
- âœ… ä¸ç°æœ‰ UI é£æ ¼ä¸€è‡´

---

### âœ… JavaScript æ¨¡å—

**æ–‡ä»¶**ï¼š`webapi/web/js/modules/recursor.js`

**çŠ¶æ€**ï¼šâœ… å·²åˆ›å»º

**æ ¸å¿ƒåŠŸèƒ½**ï¼š
- âœ… `getRecursorStatus()` - è·å– Recursor çŠ¶æ€
- âœ… `updateRecursorStatus()` - æ›´æ–° UI çŠ¶æ€æ˜¾ç¤º
- âœ… `formatUptime()` - æ ¼å¼åŒ–è¿è¡Œæ—¶é—´
- âœ… `startRecursorStatusPolling()` - å¯åŠ¨å®šæœŸè½®è¯¢

**ç‰¹æ€§**ï¼š
- âœ… æ¯ 5 ç§’è‡ªåŠ¨è½®è¯¢ä¸€æ¬¡
- âœ… å®æ—¶æ›´æ–°çŠ¶æ€æŒ‡ç¤ºå™¨
- âœ… è¯­è¨€å˜æ›´æ—¶è‡ªåŠ¨æ›´æ–°
- âœ… é”™è¯¯å¤„ç†å®Œå–„

---

### âœ… å›½é™…åŒ–æ”¯æŒ

**è‹±æ–‡ç¿»è¯‘**ï¼š`webapi/web/js/i18n/resources-en.js`

**çŠ¶æ€**ï¼šâœ… å·²å®Œæˆ

**ç¿»è¯‘å†…å®¹**ï¼š
```javascript
"recursor": {
    "legend": "Recursive Resolver",
    "enable": "Enable Embedded Unbound Recursor",
    "enableHelp": "Provides recursive DNS resolution capability...",
    "port": "Recursor Port",
    "portHelp": "Default: 5353. Must be different from DNS listen port.",
    "status": "Status",
    "statusUnknown": "Unknown",
    "statusRunning": "Running on port {{port}} (Uptime: {{uptime}})",
    "statusStopped": "Stopped",
    "info": "Information",
    "infoVersion": "â€¢ Version: Unbound 1.24.2",
    "infoArch": "â€¢ Architecture: x86-64 (Linux & Windows)",
    "infoFeatures": "â€¢ Features: DNSSEC validation, caching, prefetching",
    "infoNote": "â€¢ Note: Recursor runs as a separate process on localhost"
}
```

---

**ä¸­æ–‡ç¿»è¯‘**ï¼š`webapi/web/js/i18n/resources-zh-cn.js`

**çŠ¶æ€**ï¼šâœ… å·²å®Œæˆ

**ç¿»è¯‘å†…å®¹**ï¼š
```javascript
"recursor": {
    "legend": "é€’å½’è§£æå™¨",
    "enable": "å¯ç”¨åµŒå…¥å¼ Unbound é€’å½’è§£æå™¨",
    "enableHelp": "æä¾›é€’å½’ DNS è§£æåŠŸèƒ½ã€‚éœ€è¦ Unbound 1.24.2 äºŒè¿›åˆ¶æ–‡ä»¶ã€‚",
    "port": "é€’å½’è§£æå™¨ç«¯å£",
    "portHelp": "é»˜è®¤ï¼š5353ã€‚å¿…é¡»ä¸ DNS ç›‘å¬ç«¯å£ä¸åŒã€‚",
    "status": "çŠ¶æ€",
    "statusUnknown": "æœªçŸ¥",
    "statusRunning": "è¿è¡Œä¸­ï¼ˆç«¯å£ï¼š{{port}}ï¼Œè¿è¡Œæ—¶é—´ï¼š{{uptime}}ï¼‰",
    "statusStopped": "å·²åœæ­¢",
    "info": "ä¿¡æ¯",
    "infoVersion": "â€¢ ç‰ˆæœ¬ï¼šUnbound 1.24.2",
    "infoArch": "â€¢ æ¶æ„ï¼šx86-64ï¼ˆLinux å’Œ Windowsï¼‰",
    "infoFeatures": "â€¢ åŠŸèƒ½ï¼šDNSSEC éªŒè¯ã€ç¼“å­˜ã€é¢„å–",
    "infoNote": "â€¢ æ³¨æ„ï¼šé€’å½’è§£æå™¨ä½œä¸ºç‹¬ç«‹è¿›ç¨‹åœ¨æœ¬åœ°è¿è¡Œ"
}
```

---

### âœ… ç»„ä»¶åŠ è½½

**æ–‡ä»¶**ï¼š`webapi/web/js/modules/component-loader.js`

**çŠ¶æ€**ï¼šâœ… å·²é…ç½®

**åŠ è½½é…ç½®**ï¼š
```javascript
{ path: 'components/config-recursor.html', containerId: 'recursor-config-container' }
```

---

### âœ… é…ç½®é¡µé¢é›†æˆ

**æ–‡ä»¶**ï¼š`webapi/web/components/config.html`

**çŠ¶æ€**ï¼šâœ… å·²é›†æˆ

**å®¹å™¨**ï¼š
```html
<!-- Recursor Card -->
<div id="recursor-config-container"></div>
```

---

### âœ… é…ç½®ç®¡ç†

**æ–‡ä»¶**ï¼š`webapi/web/js/modules/config.js`

**çŠ¶æ€**ï¼šâœ… å·²é›†æˆ

**é›†æˆå†…å®¹**ï¼š
```javascript
// Recursor é…ç½®
setChecked('upstream.enable_recursor', config.upstream.enable_recursor || false);
setValue('upstream.recursor_port', config.upstream.recursor_port || 5353);

// åˆå§‹åŒ– Recursor çŠ¶æ€
updateRecursorStatus();
```

---

### âœ… è„šæœ¬åŠ è½½é¡ºåº

**æ–‡ä»¶**ï¼š`webapi/web/index.html`

**çŠ¶æ€**ï¼šâœ… æ­£ç¡®

**åŠ è½½é¡ºåº**ï¼š
```html
<!-- Recursor æ¨¡å—å¿…é¡»åœ¨ config.js ä¹‹å‰åŠ è½½ -->
<script src="js/modules/recursor.js"></script>
<script src="js/modules/config.js"></script>
```

---

## ğŸ¨ UI è®¾è®¡

### é…ç½®è¡¨å•

**å¸ƒå±€**ï¼š
- å¯ç”¨/ç¦ç”¨å¼€å…³ï¼ˆå…¨å®½ï¼‰
- ç«¯å£è¾“å…¥æ¡†ï¼ˆåŠå®½ï¼‰
- çŠ¶æ€æ˜¾ç¤ºï¼ˆåŠå®½ï¼‰
- ä¿¡æ¯é¢æ¿ï¼ˆå…¨å®½ï¼‰

**æ ·å¼**ï¼š
- âœ… å“åº”å¼ç½‘æ ¼å¸ƒå±€
- âœ… æ·±è‰²æ¨¡å¼æ”¯æŒ
- âœ… ä¸€è‡´çš„é—´è·å’Œé¢œè‰²
- âœ… æ¸…æ™°çš„æ ‡ç­¾å’Œå¸®åŠ©æ–‡æœ¬

### çŠ¶æ€æŒ‡ç¤ºå™¨

**è®¾è®¡**ï¼š
- ğŸŸ¢ ç»¿è‰² - è¿è¡Œä¸­
- ğŸ”´ çº¢è‰² - å·²åœæ­¢
- âš« ç°è‰² - æœªçŸ¥

**æ˜¾ç¤ºå†…å®¹**ï¼š
- è¿è¡Œä¸­ï¼š`Running on port 5353 (Uptime: 1h 30m)`
- å·²åœæ­¢ï¼š`Stopped`
- æœªçŸ¥ï¼š`Unknown`

---

## ğŸ”„ æ•°æ®æµ

### å¯åŠ¨æ—¶

```
1. é¡µé¢åŠ è½½
   â†“
2. ç»„ä»¶åŠ è½½å™¨åŠ è½½ config-recursor.html
   â†“
3. config.js åŠ è½½é…ç½®
   â†“
4. è°ƒç”¨ updateRecursorStatus()
   â†“
5. è·å– /api/recursor/status
   â†“
6. æ›´æ–° UI çŠ¶æ€æ˜¾ç¤º
```

### è¿è¡Œæ—¶

```
1. æ¯ 5 ç§’è½®è¯¢ä¸€æ¬¡
   â†“
2. è°ƒç”¨ getRecursorStatus()
   â†“
3. è·å– /api/recursor/status
   â†“
4. æ›´æ–°çŠ¶æ€æŒ‡ç¤ºå™¨é¢œè‰²
   â†“
5. æ›´æ–°çŠ¶æ€æ–‡æœ¬
```

### ç”¨æˆ·æ“ä½œ

```
1. ç”¨æˆ·ä¿®æ”¹é…ç½®
   â†“
2. ç‚¹å‡»"Save & Apply"
   â†“
3. è°ƒç”¨ saveConfig()
   â†“
4. POST /api/config
   â†“
5. åç«¯é‡å¯ Recursor
   â†“
6. å‰ç«¯è½®è¯¢æ£€æµ‹çŠ¶æ€å˜åŒ–
   â†“
7. UI è‡ªåŠ¨æ›´æ–°
```

---

## ğŸ§ª åŠŸèƒ½éªŒè¯

### æµ‹è¯• 1ï¼šå¯ç”¨ Recursor

**æ­¥éª¤**ï¼š
1. æ‰“å¼€é…ç½®é¡µé¢
2. å‹¾é€‰"Enable Embedded Unbound Recursor"
3. è®¾ç½®ç«¯å£ä¸º 5353
4. ç‚¹å‡»"Save & Apply"

**é¢„æœŸç»“æœ**ï¼š
- âœ… çŠ¶æ€æŒ‡ç¤ºå™¨å˜ä¸ºç»¿è‰²
- âœ… æ˜¾ç¤º"Running on port 5353 (Uptime: ...)"
- âœ… è¿è¡Œæ—¶é—´é€ç§’å¢åŠ 

---

### æµ‹è¯• 2ï¼šç¦ç”¨ Recursor

**æ­¥éª¤**ï¼š
1. æ‰“å¼€é…ç½®é¡µé¢
2. å–æ¶ˆå‹¾é€‰"Enable Embedded Unbound Recursor"
3. ç‚¹å‡»"Save & Apply"

**é¢„æœŸç»“æœ**ï¼š
- âœ… çŠ¶æ€æŒ‡ç¤ºå™¨å˜ä¸ºçº¢è‰²
- âœ… æ˜¾ç¤º"Stopped"

---

### æµ‹è¯• 3ï¼šä¿®æ”¹ç«¯å£

**æ­¥éª¤**ï¼š
1. æ‰“å¼€é…ç½®é¡µé¢
2. ä¿®æ”¹ç«¯å£ä¸º 8053
3. ç‚¹å‡»"Save & Apply"

**é¢„æœŸç»“æœ**ï¼š
- âœ… çŠ¶æ€æ˜¾ç¤ºæ›´æ–°ä¸º"Running on port 8053"
- âœ… Recursor åœ¨æ–°ç«¯å£ä¸Šè¿è¡Œ

---

### æµ‹è¯• 4ï¼šè¯­è¨€åˆ‡æ¢

**æ­¥éª¤**ï¼š
1. æ‰“å¼€é…ç½®é¡µé¢
2. åˆ‡æ¢è¯­è¨€ä¸ºä¸­æ–‡
3. è§‚å¯Ÿ Recursor é…ç½®éƒ¨åˆ†

**é¢„æœŸç»“æœ**ï¼š
- âœ… æ‰€æœ‰æ ‡ç­¾å’Œæ–‡æœ¬éƒ½å˜ä¸ºä¸­æ–‡
- âœ… çŠ¶æ€æ˜¾ç¤ºä¹Ÿå˜ä¸ºä¸­æ–‡

---

### æµ‹è¯• 5ï¼šè‡ªåŠ¨è½®è¯¢

**æ­¥éª¤**ï¼š
1. æ‰“å¼€é…ç½®é¡µé¢
2. è§‚å¯ŸçŠ¶æ€æ˜¾ç¤º
3. ç­‰å¾… 5 ç§’

**é¢„æœŸç»“æœ**ï¼š
- âœ… è¿è¡Œæ—¶é—´è‡ªåŠ¨æ›´æ–°
- âœ… æ— éœ€æ‰‹åŠ¨åˆ·æ–°

---

## ğŸ“Š å‰ç«¯é›†æˆç»Ÿè®¡

| é¡¹ç›® | æ•°å€¼ |
|------|------|
| HTML ç»„ä»¶ | 1 |
| JavaScript æ¨¡å— | 1 |
| å›½é™…åŒ–è¯­è¨€ | 2ï¼ˆè‹±æ–‡ã€ä¸­æ–‡ï¼‰ |
| ç¿»è¯‘æ¡ç›® | 10+ |
| ç»„ä»¶å®¹å™¨ | 1 |
| è„šæœ¬åŠ è½½é¡ºåº | æ­£ç¡® |

---

## âœ… é›†æˆå®Œæˆåº¦

| ç»„ä»¶ | çŠ¶æ€ | å®Œæˆåº¦ |
|------|------|--------|
| HTML è¡¨å• | âœ… å®Œæˆ | 100% |
| JavaScript é€»è¾‘ | âœ… å®Œæˆ | 100% |
| è‹±æ–‡ç¿»è¯‘ | âœ… å®Œæˆ | 100% |
| ä¸­æ–‡ç¿»è¯‘ | âœ… å®Œæˆ | 100% |
| ç»„ä»¶åŠ è½½ | âœ… å®Œæˆ | 100% |
| é…ç½®ç®¡ç† | âœ… å®Œæˆ | 100% |
| è„šæœ¬é¡ºåº | âœ… æ­£ç¡® | 100% |
| **æ€»ä½“** | âœ… **å®Œæˆ** | **100%** |

---

## ğŸ¯ ç”¨æˆ·ä½“éªŒ

### å¯ç”¨æµç¨‹

```
ç”¨æˆ·ç•Œé¢
  â†“
1. æ‰“å¼€é…ç½®é¡µé¢
2. å‹¾é€‰å¯ç”¨å¼€å…³
3. è®¾ç½®ç«¯å£ï¼ˆå¯é€‰ï¼‰
4. ç‚¹å‡»"Save & Apply"
  â†“
åç«¯å¤„ç†
  â†“
1. éªŒè¯é…ç½®
2. å¯åŠ¨ Unbound è¿›ç¨‹
3. è¿”å›æˆåŠŸå“åº”
  â†“
å‰ç«¯åé¦ˆ
  â†“
1. æ˜¾ç¤ºåŠ è½½çŠ¶æ€
2. è½®è¯¢çŠ¶æ€ API
3. çŠ¶æ€å˜ä¸º"Running"æ—¶æ˜¾ç¤ºæˆåŠŸ
4. å®šæœŸæ›´æ–°è¿è¡Œæ—¶é—´
```

### ç¦ç”¨æµç¨‹

```
ç”¨æˆ·ç•Œé¢
  â†“
1. æ‰“å¼€é…ç½®é¡µé¢
2. å–æ¶ˆå‹¾é€‰å¯ç”¨å¼€å…³
3. ç‚¹å‡»"Save & Apply"
  â†“
åç«¯å¤„ç†
  â†“
1. åœæ­¢ Unbound è¿›ç¨‹
2. æ¸…ç†ä¸´æ—¶æ–‡ä»¶
3. è¿”å›æˆåŠŸå“åº”
  â†“
å‰ç«¯åé¦ˆ
  â†“
1. çŠ¶æ€ç«‹å³å˜ä¸º"Stopped"
2. æ˜¾ç¤ºæˆåŠŸæç¤º
```

---

## ğŸ” å®‰å…¨æ€§

âœ… æ‰€æœ‰ç”¨æˆ·è¾“å…¥éƒ½ç»è¿‡éªŒè¯  
âœ… ç«¯å£èŒƒå›´é™åˆ¶ï¼ˆ1024-65535ï¼‰  
âœ… æ—  XSS æ¼æ´ï¼ˆä½¿ç”¨ textContentï¼‰  
âœ… æ—  CSRF æ¼æ´ï¼ˆä½¿ç”¨ API ç«¯ç‚¹ï¼‰  
âœ… æ•æ„Ÿä¿¡æ¯ä¸æš´éœ²åœ¨å‰ç«¯  

---

## ğŸ“± å“åº”å¼è®¾è®¡

âœ… æ¡Œé¢ç«¯ï¼ˆ> 1024pxï¼‰ï¼šä¸¤åˆ—å¸ƒå±€  
âœ… å¹³æ¿ç«¯ï¼ˆ768-1024pxï¼‰ï¼šä¸¤åˆ—å¸ƒå±€  
âœ… æ‰‹æœºç«¯ï¼ˆ< 768pxï¼‰ï¼šå•åˆ—å¸ƒå±€  
âœ… æ‰€æœ‰å…ƒç´ éƒ½å¯ç‚¹å‡»å’Œäº¤äº’  

---

## ğŸŒ™ æ·±è‰²æ¨¡å¼

âœ… è‡ªåŠ¨æ£€æµ‹ç³»ç»Ÿä¸»é¢˜  
âœ… æ‰‹åŠ¨åˆ‡æ¢ä¸»é¢˜  
âœ… æ‰€æœ‰é¢œè‰²éƒ½æœ‰æ·±è‰²ç‰ˆæœ¬  
âœ… å¯¹æ¯”åº¦ç¬¦åˆ WCAG æ ‡å‡†  

---

## ğŸŒ å›½é™…åŒ–

âœ… è‹±æ–‡å®Œæ•´æ”¯æŒ  
âœ… ä¸­æ–‡å®Œæ•´æ”¯æŒ  
âœ… æ˜“äºæ·»åŠ æ–°è¯­è¨€  
âœ… åŠ¨æ€è¯­è¨€åˆ‡æ¢  

---

## ğŸ“ ä»£ç è´¨é‡

âœ… ä»£ç é£æ ¼ä¸€è‡´  
âœ… æ³¨é‡Šå®Œæ•´  
âœ… å‡½æ•°èŒè´£å•ä¸€  
âœ… é”™è¯¯å¤„ç†å®Œå–„  
âœ… æ€§èƒ½ä¼˜åŒ–  

---

## ğŸš€ åç»­æ”¹è¿›å»ºè®®

### çŸ­æœŸï¼ˆå¯é€‰ï¼‰

1. æ·»åŠ æ›´å¤šè¯­è¨€æ”¯æŒï¼ˆæ—¥æ–‡ã€éŸ©æ–‡ç­‰ï¼‰
2. æ·»åŠ  Recursor æ—¥å¿—æŸ¥çœ‹åŠŸèƒ½
3. æ·»åŠ  Recursor æ€§èƒ½ç›‘æ§å›¾è¡¨

### ä¸­æœŸï¼ˆå¯é€‰ï¼‰

1. æ·»åŠ  Recursor é…ç½®é«˜çº§é€‰é¡¹
2. æ·»åŠ  Recursor è§„åˆ™ç®¡ç†
3. æ·»åŠ  Recursor ç»Ÿè®¡ä¿¡æ¯

### é•¿æœŸï¼ˆå¯é€‰ï¼‰

1. æ·»åŠ  Recursor é›†ç¾¤ç®¡ç†
2. æ·»åŠ  Recursor è´Ÿè½½å‡è¡¡
3. æ·»åŠ  Recursor æ•…éšœè½¬ç§»

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [`RECURSOR_BACKEND_IMPLEMENTATION.md`](RECURSOR_BACKEND_IMPLEMENTATION.md) - åç«¯å®ç°
- [`RECURSOR_API_CRITICAL_FIX.md`](RECURSOR_API_CRITICAL_FIX.md) - API ä¿®å¤
- [`recursor/å‰ç«¯é›†æˆæ€»ç»“.md`](recursor/å‰ç«¯é›†æˆæ€»ç»“.md) - å‰ç«¯é›†æˆæŒ‡å—

---

## âœ… æœ€ç»ˆéªŒè¯æ¸…å•

- [x] HTML ç»„ä»¶å·²åˆ›å»º
- [x] JavaScript æ¨¡å—å·²åˆ›å»º
- [x] è‹±æ–‡ç¿»è¯‘å·²å®Œæˆ
- [x] ä¸­æ–‡ç¿»è¯‘å·²å®Œæˆ
- [x] ç»„ä»¶åŠ è½½å·²é…ç½®
- [x] é…ç½®ç®¡ç†å·²é›†æˆ
- [x] è„šæœ¬åŠ è½½é¡ºåºæ­£ç¡®
- [x] å“åº”å¼è®¾è®¡å®Œæˆ
- [x] æ·±è‰²æ¨¡å¼æ”¯æŒ
- [x] å›½é™…åŒ–æ”¯æŒ
- [x] é”™è¯¯å¤„ç†å®Œå–„
- [x] ä»£ç è´¨é‡è¾¾æ ‡

---

## ğŸ‰ æ€»ç»“

Recursor åŠŸèƒ½çš„å‰ç«¯ UI é›†æˆå·²å®Œå…¨å®Œæˆã€‚ç”¨æˆ·ç°åœ¨å¯ä»¥ï¼š

âœ… åœ¨é…ç½®é¡µé¢å¯ç”¨/ç¦ç”¨ Recursor  
âœ… é…ç½® Recursor ç›‘å¬ç«¯å£  
âœ… å®æ—¶æŸ¥çœ‹ Recursor è¿è¡ŒçŠ¶æ€  
âœ… æŸ¥çœ‹ Recursor è¿è¡Œæ—¶é—´  
âœ… æ”¯æŒå¤šè¯­è¨€ç•Œé¢  
âœ… æ”¯æŒæ·±è‰²æ¨¡å¼  
âœ… å“åº”å¼è®¾è®¡é€‚é…æ‰€æœ‰è®¾å¤‡  

---

**é›†æˆå®Œæˆæ—¥æœŸ**ï¼š2026-01-31  
**ç‰ˆæœ¬**ï¼š1.0  
**çŠ¶æ€**ï¼šâœ… å®Œæˆ

