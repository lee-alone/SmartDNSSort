# Ping 包 - 未使用警告说明

## 概述

`ping/ping.go` 中存在一个未使用字段的 linter 警告。本文档解释了为什么保留这个字段以及为什么这是预期的行为。

## 警告详情

### 警告信息
```
ping/ping.go: Warning: field strategy is unused (U1000) (27:1)
```

### 字段信息
- **字段名**: `strategy`
- **类型**: `string`
- **位置**: `Pinger` 结构体
- **状态**: 已弃用，保留用于向后兼容

## 为什么保留这个字段？

### 1. 向后兼容性
- 早期版本的 API 可能包含这个字段
- 移除会导致依赖此 API 的外部代码编译失败
- 保留字段可以确保平滑的版本升级

### 2. 未来扩展
- 如果未来需要支持多种 ping 策略，此字段可以被重新激活
- 保留字段为未来的功能改进预留了空间

### 3. 设计一致性
- 保持结构体的完整性
- 避免在代码中留下"孤立"的参数

## 当前实现

### 使用的策略
所有 ping 操作都使用 `smartPing()` 方法，该方法实现了智能混合探测：

1. **TCP 443 探测** - 测试 HTTPS 连接
2. **TLS 握手验证** - 验证 TLS 连接（带 SNI）
3. **UDP DNS 查询** - 备选方案（端口 53）
4. **TCP 80 探测** - 可选的 HTTP 测试

### 为什么不使用 strategy 字段？
- `smartPing` 策略已经足够优秀，能够处理大多数网络环境
- 统一使用一种策略简化了代码逻辑
- 提高了可维护性和可预测性

## 其他已解决的警告

### udpDnsPing 中的 ctx 参数
**状态**: ✅ 已解决

**解决方法**: 添加了文档注释说明 `ctx` 参数的用途
```go
// ctx 用于支持上下文取消，虽然当前实现使用 DialTimeout，但保留以便未来改进
func (p *Pinger) udpDnsPing(ctx context.Context, ip string) int {
```

## 诊断结果

### 当前状态
```
ping/ping.go: 1 diagnostic(s)
  - Warning: field strategy is unused (U1000) (27:1)
```

### 预期行为
这个警告是预期的，不影响功能。它表明：
- 字段被定义但未被使用
- 这是有意的设计决策（向后兼容性）
- 代码功能完全正常

## 建议

### 对于维护者
- 保留此字段以维持 API 兼容性
- 在文档中清楚地标记为"已弃用"
- 如果未来需要移除，应在主版本更新时进行

### 对于使用者
- 不要在新代码中使用 `strategy` 字段
- 所有 ping 操作都使用 `smartPing` 策略
- 如果需要自定义策略，请提交功能请求

## 相关文件

- `ping/ping.go` - 核心实现
- `ping/PING_NOTES.md` - 详细的实现说明
- `ping/ping_test.go` - 单元测试

